---
title: "p8105_hw5_ks3663"
author: "Kee-Young Shin"
date: "November 3, 2018"
output: html_document
---

```{r}
library(tidyverse)
library(purrr)
library(RCurl)

```

## Problem 1
```{r}

files_list = paste0("./data/", list.files("./data"))
files_list

output = map_df(files_list, read.csv) %>% 
  add_column(files_list, .before = "week_1") %>% 
  mutate(files_list = str_replace(files_list, "./data/", ""),
         files_list = str_replace(files_list, ".csv", "")) %>% 
  separate(files_list, into = c("Control Arm", "Subject ID"), sep = "_") %>% 
  janitor::clean_names()
output

```

```{r}

# make spaghetti plot for control arm
output %>% 
  filter(control_arm == "con") %>% 
  gather(key = week, value = observation, week_1:week_8) %>% 
  arrange(subject_id) %>% 
  group_by(subject_id) %>% 
  ggplot(aes(x = week, y = observation, color = subject_id, group = subject_id)) + 
    geom_line()

# make spaghetti plot for experimental arm
output %>% 
  filter(control_arm == "exp") %>% 
  gather(key = week, value = observation, week_1:week_8) %>% 
  arrange(subject_id) %>% 
  group_by(subject_id) %>% 
  ggplot(aes(x = week, y = observation, color = subject_id, group = subject_id)) + 
    geom_line()
```

## Problem 2
```{r}
homicide_df = read.csv(text = getURL("https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv"))

homicide_df
                       
```

